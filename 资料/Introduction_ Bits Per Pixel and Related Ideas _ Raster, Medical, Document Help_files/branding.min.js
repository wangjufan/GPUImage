var allTabSetIds=new Array,allLSTSetIds=new Object,isHelp1,curLoc=document.location+".";function OnLoad(defaultLanguage){var defLang;defLang=void 0===defaultLanguage||null==defaultLanguage||""==defaultLanguage?"vb":defaultLanguage;try{var footer=document.getElementById("pageFooter");if(footer){var footerParent=document.body;footer.parentElement!=footerParent&&(footer.parentElement.removeChild(footer),footerParent.appendChild(footer))}}catch(e){}var language=GetCookie("CodeSnippetContainerLanguage",defLang);if(UpdateLST(language),allTabSetIds.length>0)for(var i=0;i<allTabSetIds.length;){for(var tabCount=1;null!=document.getElementById(allTabSetIds[i]+"_tab"+tabCount);)tabCount++;--tabCount<2?-1!=navigator.userAgent.toLowerCase().indexOf("chrome")&&(document.getElementById(allTabSetIds[i]+"_copyCode").style.display="none"):SetCurrentLanguage(allTabSetIds[i],language,tabCount),i++}InitializeToc()}function InitializeToc(){}function UpdateLST(language){for(var lstMember in allLSTSetIds){var devLangSpan=document.getElementById(lstMember);if(null!=devLangSpan){null!=devLangSpan.previousSibling&&null!=devLangSpan.previousSibling.nodeValue&&(devLangSpan.previousSibling.nodeValue=devLangSpan.previousSibling.nodeValue.replace(/\s+$/,""));for(var langs=allLSTSetIds[lstMember].split("|"),k=0,keyValue;k<langs.length;){if((keyValue=langs[k].split("="))[0]==language){devLangSpan.innerHTML=keyValue[1],null!=devLangSpan.parentNode&&null!=devLangSpan.parentNode.nextSibling&&(null==devLangSpan.parentNode.nextSibling.nodeValue||devLangSpan.parentNode.nextSibling.nodeValue.substring(0,1).match(/[.,);:!\/?]/)||(devLangSpan.innerHTML=keyValue[1]+" "));break}k++}if(k>=langs.length){if("nu"!=language)for(k=0;k<langs.length;){if("nu"==(keyValue=langs[k].split("="))[0]){devLangSpan.innerHTML=keyValue[1],null!=devLangSpan.parentNode&&null!=devLangSpan.parentNode.nextSibling&&(null==devLangSpan.parentNode.nextSibling.nodeValue||devLangSpan.parentNode.nextSibling.nodeValue.substring(0,1).match(/[.,);:!\/?]/)||(devLangSpan.innerHTML=keyValue[1]+" "));break}k++}k>=langs.length&&(devLangSpan.innerHTML="")}}}}function GetCookie(cookieName,defaultValue){if(isHelp1)try{var globals,value=Help1Globals.Load(cookieName);return null==value&&(value=defaultValue),value}catch(e){return defaultValue}for(var cookie=document.cookie.split("; "),i=0;i<cookie.length;i++){var crumb=cookie[i].split("=");if(cookieName==crumb[0])return unescape(crumb[1])}return defaultValue}function SetCookie(name,value){if(isHelp1)try{var globals;Help1Globals.Save(name,value)}catch(e){}else{var today=new Date;today.setTime(today.getTime());var expires_date=new Date(today.getTime()+5184e6);document.cookie=name+"="+escape(value)+";expires="+expires_date.toGMTString()+";path=/"}}function AddLanguageSpecificTextSet(lstId){var keyValue=lstId.split("?");allLSTSetIds[keyValue[0]]=keyValue[1]}function AddLanguageTabSet(tabSetId){allTabSetIds.push(tabSetId)}function ChangeTab(tabSetId,language,snippetIdx,snippetCount){SetCookie("CodeSnippetContainerLanguage",language),SetActiveTab(tabSetId,snippetIdx,snippetCount),UpdateLST(language);for(var i=0;i<allTabSetIds.length;){if(allTabSetIds[i]!=tabSetId){for(var tabCount=1;null!=document.getElementById(allTabSetIds[i]+"_tab"+tabCount);)tabCount++;--tabCount>1&&SetCurrentLanguage(allTabSetIds[i],language,tabCount)}i++}}function SetCurrentLanguage(tabSetId,language,tabCount){for(var tabIndex=1;tabIndex<=tabCount;){var tabTemp=document.getElementById(tabSetId+"_tab"+tabIndex);if(null!=tabTemp&&-1!=tabTemp.innerHTML.indexOf("'"+language+"'"))break;tabIndex++}if(tabIndex>tabCount&&(tabIndex=1,"codeSnippetContainerTabPhantom"==document.getElementById(tabSetId+"_tab1").className))for(tabIndex++;tabIndex<=tabCount;){var tab=document.getElementById(tabSetId+"_tab"+tabIndex);if("codeSnippetContainerTabPhantom"!=tab.className){tab.className="codeSnippetContainerTabActive",document.getElementById(tabSetId+"_code_Div"+j).style.display="block";break}tabIndex++}SetActiveTab(tabSetId,tabIndex,tabCount)}function SetActiveTab(tabSetId,tabIndex,tabCount){for(var i=1;i<=tabCount;){var tabTemp=document.getElementById(tabSetId+"_tab"+i);if(null!=tabTemp){"codeSnippetContainerTabActive"==tabTemp.className?tabTemp.className="codeSnippetContainerTab":"codeSnippetContainerTabPhantom"==tabTemp.className&&(tabTemp.style.display="none");var codeTemp=document.getElementById(tabSetId+"_code_Div"+i);"none"!=codeTemp.style.display&&(codeTemp.style.display="none")}i++}"codeSnippetContainerTabPhantom"!=document.getElementById(tabSetId+"_tab"+tabIndex).className?document.getElementById(tabSetId+"_tab"+tabIndex).className="codeSnippetContainerTabActive":document.getElementById(tabSetId+"_tab"+tabIndex).style.display="block",document.getElementById(tabSetId+"_code_Div"+tabIndex).style.display="block",-1==navigator.userAgent.toLowerCase().indexOf("chrome")?document.getElementById(tabSetId+"_copyCode").style.display="inline":document.getElementById(tabSetId+"_copyCode").style.display="none"}function CopyToClipboard(tabSetId){var tabTemp,contentId,i=1;do{if(contentId=tabSetId+"_code_Div"+i,null!=(tabTemp=document.getElementById(contentId))&&"none"!=tabTemp.style.display)break;i++}while(null!=tabTemp);if(null!=tabTemp)if(window.clipboardData)try{window.clipboardData.setData("Text",document.getElementById(contentId).innerText)}catch(e){alert("Permission denied. Enable copying to the clipboard.")}else if(window.netscape)try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var clip=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!clip)return;var trans=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!trans)return;trans.addDataFlavor("text/unicode");var str=new Object,len=new Object,str=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString),copytext=document.getElementById(contentId).textContent;str.data=copytext,trans.setTransferData("text/unicode",str,2*copytext.length);var clipid=Components.interfaces.nsIClipboard;clip.setData(trans,null,clipid.kGlobalClipboard)}catch(e){alert('Permission denied. Enter "about:config" in the address bar and double-click the "signed.applets.codebase_principal_support" setting to enable copying to the clipboard.')}}function SectionExpandCollapse(togglePrefix){var image=document.getElementById(togglePrefix+"Toggle"),section=document.getElementById(togglePrefix+"Section");null!=image&&null!=section&&(""==section.style.display?(image.src=image.src.replace("SectionExpanded.png","SectionCollapsed.png"),section.style.display="none"):(image.src=image.src.replace("SectionCollapsed.png","SectionExpanded.png"),section.style.display=""))}function SectionExpandCollapse_CheckKey(togglePrefix,eventArgs){13==eventArgs.keyCode&&SectionExpandCollapse(togglePrefix)}0==curLoc.indexOf("mk:@MSITStore")?(isHelp1=!0,curLoc="ms-its:"+curLoc.substring(14,curLoc.length-1),document.location.replace(curLoc)):isHelp1=0==curLoc.indexOf("ms-its:");var Help1Globals={UserDataCache:function(){var userData;return document.getElementById("userDataCache")},Load:function(key){var userData=this.UserDataCache(),value;return userData.load("userDataSettings"),userData.getAttribute(key)},Save:function(key,value){var userData=this.UserDataCache();userData.setAttribute(key,value),userData.save("userDataSettings")}};