$(function(){var t=$.connection.chatHub,n=new ChatUtils,i,u=[],l,e=!0,s=!1,a=!1,v=!1,y="",r,p,o,h=3,f=!1,c=!0;$.getJSON("/content/chat/resources/triggers.json?time="+(new Date).getTime(),function(t){r=n.parseTrigger(t)}).done(function(){function rt(){t.client.broadcastMessage=function(t){var r=b(t),i;t.Id in u||(u[t.Id]=t,k(t),d(t),i=n.sameUser(r),i==null?(msg='<li class="'+r+'"><strong>'+n.htmlEncode(t.Name)+"<\/strong>: <br />"+n.htmlEncode(t.Text)+"<\/li>",$("#discussion-list").append(msg)):(msg="<br />"+n.htmlEncode(t.Text),i.append(msg)),$("#footer-chat").hasClass("in")||f||$("#footer-chat").collapse("show"),n.autoScroll("main-discussion-div"))};t.client.broadcastCode=function(t){var e=b(t),i,r;t.Id in u||(u[t.Id]=t,k(t),d(t),i=n.sameUser(e),r=n.getLanguageClass(t.Language),i==null?(msg='<li class="'+e+'"><strong>'+n.htmlEncode(t.Name)+'<\/strong>: <br /><pre><code class= "language-'+r+'">'+t.Text+"<\/li>",$("#discussion-list").append(msg)):(msg=' <br /><pre><code class= "language-'+r+'">'+t.Text+"<\/li>",i.append(msg)),$("#footer-chat").hasClass("in")||f||$("#footer-chat").collapse("show"),typeof Prism.highlightAll()=="function"&&Prism.highlightAll(),n.autoScroll("main-discussion-div"))};t.client.broadcastDownload=function(t){var r=b(t),i;t.Id in u||(u[t.Id]=t,k(t),d(t),i=n.sameUser(r),i==null?(msg='<li class="'+r+'"><strong>'+n.htmlEncode(t.Name)+"<\/strong>: <br /> File: "+n.encodeDownload(t.Text,t.FileName)+"<\/li>",$("#discussion-list").append(msg)):(msg="<br /> File: "+n.encodeDownload(t.Text,t.FileName),i.append(msg)),$("#footer-chat").hasClass("in")||f||$("#footer-chat").collapse("show"),n.autoScroll("main-discussion-div"))};t.client.endConversation=function(){tt();chatInitiated=!1;customerEnded="false";$("#discussion-list").empty()};t.client.setChatOffline=function(){e=!1;g(!1,!1,!1)};t.client.startClient=function(r,u){i=r;p=u;n.setAllowedFiles(u);nt(i.StandAloneCounter);t.server.loadExisting(r.RoomName,r.Id)};t.client.showTyping=function(n,t){n?$("#is-typing-span").text(t+" is typing..."):$("#is-typing-span").text(" ")};t.client.emailSent=function(){n.hideGroup("form-container");n.showGroup("email-sent-container")};t.client.collapseChat=function(){$("#footer-chat").collapse()};t.client.showChat=function(n){nt(n)};t.client.showForm=function(n,t,i){e=n;v=t;g(n,t,i)};t.client.showSurvey=function(){tt()};t.client.setUser=function(n){i=n};t.client.showOffline=function(){e=!1};t.client.chatAnswered=function(){a=!0};t.client.hidePersistent=function(){n.isStandAlone()||(n.isFirefox()?(f=!0,$("#footer-chat").hasClass("in")&&$("#footer-chat").collapse("hide")):n.hideGroup("footer-chat"),s=!0)};t.client.showPersistent=function(){n.isFirefox()?f=!1:n.showGroup("footer-chat");s=!1}}function ut(){$(document).on("keypress","#message-textarea",function(r){if(n.enterHandler(r)){ft($("#message-textarea").val());t.server.isTyping(!1,i.RoomName);clearInterval(o);return}i.IsTyping||(clearInterval(o),o=setInterval(function(){h--;h<=0&&w()},1e3),t.server.isTyping(!0,i.RoomName));h=2;i.isTyping=!0});$("#message-textarea").focusout(function(){w()});$("#register-submit-button").on("click",function(){$(".required-elements").hide();var i={FirstName:$("#first-name-input").val(),LastName:$("#last-name-input").val(),Email:$("#email-input").val(),Question:$("#question-input").val(),Url:window.location.href,ChosenQueue:jQuery("input[name=queue]:checked").val()};n.validateForm(i.FirstName,i.LastName,i.Email,i.Question)&&t.server.submitFormAsync(i)});$("#submit-survey").on("click",function(){var r={OverallExperience:$("input[name=rating-input-1]:checked").val(),TechnicalKnowledge:$("input[name=rating-input-2]:checked").val(),CommunicationSkills:$("input[name=rating-input-3]:checked").val(),CommentsLiked:n.htmlEncode($("#liked-textarea").val()),CommentsDisliked:n.htmlEncode($("#disliked-textarea").val()),CommentsAdditional:n.htmlEncode($("#comments-textarea").val()),Email:i.Email,RoomName:i.RoomName};n.validateSurvey(r)&&t.server.submitSurveyAsync(r)});$("#end-conversation-button").on("click",function(){t.server.customerLeaveConnection().done(function(){$("#discussion-list").empty()});$("#discussion-list .agent").length==0&&$("#discussion-list .customer").length==0&&$("#minimize-conversation-button").click()});$("#sound-button").click(function(){$("#sound-button span").hasClass("glyphicon-volume-up")?(n.setCookie("LEADTOOLSChatSound","false",1200),$("#sound-button span").addClass("glyphicon-volume-off"),$("#sound-button span").removeClass("glyphicon-volume-up"),$("#sound-button")[0].parentElement.title=" Sound Is Off"):$("#sound-button span").hasClass("glyphicon-volume-off")&&(n.deleteCookie("LEADTOOLSChatSound"),$("#sound-button span").removeClass("glyphicon-volume-off"),$("#sound-button span").addClass("glyphicon-volume-up"),$("#sound-button")[0].parentElement.title=" Sound Is On")});$("#send-file-button").click(function(){$("#upload-container").hasClass("hidden-group")?(n.showGroup("upload-container"),$("#code-container").hasClass("hidden-group")||(n.hideGroup("code-container"),updateTextareaPlaceholder())):$("#file-upload-input")[0].files.length==0&&n.hideGroup("upload-container");typeof resizeStandaloneChat=="function"&&resizeStandaloneChat()});$("#send-code-button").click(function(){$("#language-combobox-input").is(":visible")?n.hideGroup("code-container"):(n.showGroup("code-container"),$("#file-upload-input").is(":visible")&&n.hideGroup("upload-container"));n.updateTextareaPlaceHolder();typeof resizeStandaloneChat=="function"&&resizeStandaloneChat()});$("#open-separate-window-button").click(function(){window.open(n.popoutUrl,"standalonechat","width=400, height=600,status=no, toolbar=no, menubar=no, location=no, addressbar=no, resizable=yes")});$("#close-separate-window-button").click(function(){n.isStandAlone()&&t.server.decrementStandAlone().done(function(){window.close()})});$("#file-upload-input").change(function(){if($("#file-upload-input input.file").val()!=""){$("#upload-progress-div").show();var t=$("#file-upload-input")[0].files[0],r=new FormData;if(t==null||t.name==null){console.log("File cannot be empty.");typeof resizeStandaloneChat=="function"&&resizeStandaloneChat();return}if(t.size>2e7){alert("File must be 20mb or smaller.");document.getElementById("file-upload-input").value="";$("#upload-progress-div").hide();return}r.append(t.name,t);r.append("roomname",i.RoomName);$.ajax({url:n.uploadUrl+i.RoomName,data:r,enctype:"multipart/form-data",processData:!1,contentType:!1,type:"POST",xhrFields:{withCredentials:!0},crossDomain:!0,success:function(r){document.getElementById("file-upload-input").value="";console.log(r);r=="success"?et(n.downloadUrl+i.RoomName+"/"+t.name,t.name,t.size):alert(r);n.hideGroup("upload-container")},error:function(n,t,i,r){var u="Error  "+t+" "+i+" "+r;n.responseText&&n.responseText[0]=="{"&&(u=JSON.parse(n.responseText).Message);console.log(u)}})}});$("#chat-toggle-button").on("click",function(){c=!1})}function ft(n){n!=null&&n.trim()!=""&&($("#language-combobox-input").is(":visible")?t.server.sendCodeAsync({Text:n,RoomName:i.RoomName,Language:$("#language-combobox-input").val()}):t.server.sendAsync({Text:n,RoomName:i.RoomName}),$("#message-textarea").val("").focus(),w())}function et(n,r,u){t.server.sendDownloadAsync({Text:n,FileName:r,FileSize:u,RoomName:i.RoomName})}function b(n){return n.Type===0?"system":n.Type===1?"customer":"agent"}function ot(){$("#chat-audio").attr("src",n.audioUrl);n.getCookie("LEADTOOLSChatSound")!=""&&($("#sound-button span").addClass("glyphicon-volume-off"),$("#sound-button span").removeClass("glyphicon-volume-up"),$("#sound-button")[0].parentElement.title=" Sound Is Off")}function k(t){t.Type!=1&&n.getCookie("LEADTOOLSChatSound")==""&&(s||document.getElementById("chat-audio").play())}function d(t){var i=new Date(n.htmlEncode(t.Time)).toTimeString().substr(0,5);l!=i&&(l=i,$("#discussion-list").append('<li><span class="time">'+i+"<\/span><\/li>"))}function g(t,i,r){n.hideGroup("progress-container");$("#question-input").val("");$("#footer-chat").removeClass("loading");n.showPersistent("footer-chat","hide-persistent");n.hideGroup("survey-container");n.hideGroup("chat-wrapper");n.showGroup("form-container");r&&n.showGroup("survey-thanks");t?(n.hideGroup("offline-button-span"),n.hideGroup("offline-container"),n.showGroup("online-button-span")):(n.showGroup("offline-button-span"),n.showGroup("offline-container"),n.hideGroup("online-button-span"));i||($("#support-radio").prop("checked",!0),n.hideGroup("queue-container"))}function nt(t){t>0&&n.isFirefox()?($("#footer-chat").hasClass("in")&&$("#footer-chat").collapse("hide"),f=!0):t>0&&!n.isFirefox()&&n.hideGroup("footer-chat");n.hideGroup("progress-container");n.showPersistent("footer-chat","hide-persistent");$("#footer-chat").removeClass("loading");n.hideGroup("offline-button-span");n.hideGroup("survey-container");n.showGroup("chat-wrapper");n.hideGroup("form-container");n.hideGroup("survey-thanks")}function tt(){n.hideGroup("progress-container");n.showGroup("survey-container");n.hideGroup("chat-wrapper");n.hideGroup("form-container");n.hideGroup("survey-thanks")}function w(){i!=null&&(t.server.isTyping(!1,i.RoomName),i.isTyping=!1,clearInterval(o))}y=r.message;var it=0;it=r.delay;$.connection.hub.url=n.siteRoot+"/signalr";$.connection.hub.qs={queue:n.queryString("queue")};n.getCookie("LEADTOOLSChat")===""&&n.setCookie("LEADTOOLSChat",n.createGuid(),1e3);ot();ut();rt();n.fillCodeComboBox();$.connection.hub.start().done(function(){n.isStandAlone()&&t.server.incrementStandAlone();t.server.setUrl(window.location.href);c&&r!=null&&r.message!=""&&setTimeout(function(){c&&e&&t.server.joinAsGuest(r.message)},r.delay*1e3)});$(window).unload(function(){w()})})});
//# sourceMappingURL=chatclient.min.js.map
