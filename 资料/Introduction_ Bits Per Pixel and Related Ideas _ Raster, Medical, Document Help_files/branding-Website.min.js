var tocWidth,searchMethod=0;function InitializeToc(){tocWidth=parseInt(GetCookie("TocWidth","280")),ResizeToc(),$(window).resize(SetNavHeight)}function SetNavHeight(){$leftNav=$("#leftNav"),$topicContent=$("#TopicContent"),leftNavPadding=$leftNav.outerHeight()-$leftNav.height(),contentPadding=$topicContent.outerHeight()-$topicContent.height(),leftNavHeight=$topicContent.outerHeight()-leftNavPadding,$leftNav.css("min-height",leftNavHeight+"px")}function OnIncreaseToc(){tocWidth<1?tocWidth=280:tocWidth+=100,tocWidth>680&&(tocWidth=0),ResizeToc(),SetCookie("TocWidth",tocWidth)}function OnResetToc(){tocWidth=0,ResizeToc(),SetCookie("TocWidth",tocWidth)}function ResizeToc(){var toc=document.getElementById("leftNav");if(toc){toc.style.width=tocWidth+"px";var leftNavPadding=0;document.getElementById("TopicContent").style.marginLeft=tocWidth+0+"px"}SetNavHeight()}function Toggle(item){var isExpanded=$(item).hasClass("tocExpanded"),childrenLoaded;if($(item).toggleClass("tocExpanded tocCollapsed"),isExpanded)Collapse($(item).parent());else if($(item).parent().attr("data-childrenloaded"))Expand($(item).parent());else{var tocid=$(item).next().attr("tocid");$.ajax({url:"../toc/"+tocid+".xml",async:!0,dataType:"xml",success:function(data){BuildChildren($(item).parent(),data)}})}}function HtmlEncode(value){return $("<div/>").text(value).html()}function BuildChildren(tocDiv,data){var childLevel=+tocDiv.attr("data-toclevel")+1,childTocLevel=childLevel>=10?10:childLevel,elements=data.getElementsByTagName("HelpTOCNode"),isRoot=!0;0==data.getElementsByTagName("HelpTOC").length&&(isRoot=!1);for(var i=elements.length-1;i>0||isRoot&&0==i;i--){var childHRef,childId=elements[i].getAttribute("Url");null!=childId&&childId.length>5?(childHRef=childId.substring(5,childId.length),childId=childId.substring(5,childId.lastIndexOf("."))):(childHRef="#",childId=elements[i].getAttribute("Id"));var existingItem=null;if(tocDiv.nextAll().each(function(){existingItem||$(this).children().last("a").attr("tocid")!=childId||(existingItem=$(this))}),null!=existingItem){var existingChildLevel=+existingItem.attr("data-toclevel"),doneMoving=!1,inserter=tocDiv;existingItem.nextAll().each(function(){!doneMoving&&+$(this).attr("data-toclevel")>existingChildLevel?(inserter.after($(this)),inserter=$(this),$(this).attr("data-toclevel",+$(this).attr("data-toclevel")+childLevel-existingChildLevel),$(this).hasClass("current")?$(this).attr("class","toclevel"+ +$(this).attr("data-toclevel")+" current"):$(this).attr("class","toclevel"+ +$(this).attr("data-toclevel"))):doneMoving=!0}),tocDiv.after(existingItem),existingItem.attr("data-toclevel",childLevel),existingItem.attr("class","toclevel"+childLevel)}else{var hasChildren=elements[i].getAttribute("HasChildren"),childTitle=HtmlEncode(elements[i].getAttribute("Title")),expander="";hasChildren&&(expander='<a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!"></a>');var text='<div class="toclevel'+childTocLevel+'" data-toclevel="'+childLevel+'">'+expander+'<a data-tochassubtree="'+hasChildren+'" href="'+childHRef+'" title="'+childTitle+'" tocid="'+childId+'"'+("#"==childHRef?' onclick="javascript: Toggle(this.previousSibling);"':"")+">"+childTitle+"</a></div>";tocDiv.after(text)}}tocDiv.attr("data-childrenloaded",!0)}function Collapse(tocDiv){var tocLevel=+tocDiv.attr("data-toclevel"),done=!1;tocDiv.nextAll().each(function(){!done&&+$(this).attr("data-toclevel")>tocLevel?$(this).hide():done=!0})}function Expand(tocDiv){var tocLevel=+tocDiv.attr("data-toclevel"),done=!1,platforms="",selectedPlatforms=$("div.bottomOn");$.each(selectedPlatforms,function(key,value){platforms+=$(value).attr("id")}),platforms=platforms.replace("frame"," ").replace("NET","dotnet").replace("IOS","osx").toLowerCase(),tocDiv.nextAll().each(function(){if(!done){var childTocLevel=+$(this).attr("data-toclevel");if(childTocLevel==tocLevel+1){var platformAtt=$(this).children("a").attr("platform"),platformArray=void 0!==platformAtt?platformAtt.split(","):"",isPlatformSelected=!1;$.each(platformArray,function(key,value){(platforms.indexOf(value)>-1||"topic"===value)&&(isPlatformSelected=!0)}),isPlatformSelected?($(this).show(),$(this).children("a").first().hasClass("tocExpanded")&&Expand($(this))):void 0!==platformAtt&&null!=platformAtt||($(this).show(),$(this).children("a").first().hasClass("tocExpanded")&&Expand($(this)))}else childTocLevel>tocLevel+1||(done=!0)}})}function OnMouseDown(event){document.addEventListener("mousemove",OnMouseMove,!0),document.addEventListener("mouseup",OnMouseUp,!0),event.preventDefault()}function OnMouseMove(event){tocWidth=event.clientX>700?700:event.clientX<100?100:event.clientX,ResizeToc()}function OnMouseUp(event){document.removeEventListener("mousemove",OnMouseMove,!0),document.removeEventListener("mouseup",OnMouseUp,!0),SetCookie("TocWidth",tocWidth)}function TransferToSearchPage(){var searchText=document.getElementById("SearchTextBox").value.trim();0!=searchText.length&&document.location.replace(encodeURI("../search.html?SearchText="+searchText))}function OnSearchPageLoad(){var queryString=decodeURI(document.location.search);if(""!=queryString){var idx,options=queryString.split(/[\?\=\&]/);for(idx=0;idx<options.length;idx++)if("SearchText"==options[idx]&&idx+1<options.length){document.getElementById("txtSearchText").value=options[idx+1],PerformSearch();break}}}function PerformSearch(){var searchText=document.getElementById("txtSearchText").value,sortByTitle=document.getElementById("chkSortByTitle").checked,searchResults=document.getElementById("searchResults");if(0!=searchText.length)if(searchResults.innerHTML="Searching...",0==searchMethod&&(searchMethod=DetermineSearchMethod()),1!=searchMethod)if(2!=searchMethod){var keywords=ParseKeywords(searchText),fileList=[];$.ajax({type:"GET",url:"fti/FTI_Files.json",dataType:"json",async:!1,success:function(data){$.each(data,function(key,val){fileList[key]=val})}});for(var letters=[],wordDictionary={},wordNotFound=!1,idx=0;idx<keywords.length&&!wordNotFound;idx++){var letter=keywords[idx].substring(0,1);-1==$.inArray(letter,letters)&&(letters.push(letter),$.ajax({type:"GET",url:"fti/FTI_"+letter.charCodeAt(0)+".json",dataType:"json",async:!1,success:function(data){var wordCount=0;$.each(data,function(key,val){wordDictionary[key]=val,wordCount++}),0==wordCount&&(wordNotFound=!0)}}))}searchResults.innerHTML=wordNotFound?"<strong>Nothing found</strong>":SearchForKeywords(keywords,fileList,wordDictionary,sortByTitle)}else $.ajax({type:"GET",url:encodeURI("SearchHelp.php?Keywords="+searchText+"&SortByTitle="+sortByTitle),success:function(html){searchResults.innerHTML=html}});else $.ajax({type:"GET",url:encodeURI("SearchHelp.aspx?Keywords="+searchText+"&SortByTitle="+sortByTitle),success:function(html){searchResults.innerHTML=html}});else searchResults.innerHTML="<strong>Nothing found</strong>"}function DetermineSearchMethod(){var method=3;try{$.ajax({type:"GET",url:"SearchHelp.aspx",async:!1,success:function(html){"<strong>"==html.substring(0,8)&&(method=1)}}),3==method&&$.ajax({type:"GET",url:"SearchHelp.php",async:!1,success:function(html){"<strong>"==html.substring(0,8)&&(method=2)}})}catch(e){}return method}function ParseKeywords(keywords){for(var keywordList=[],checkWord,words=keywords.split(/\W+/),idx=0;idx<words.length;idx++)if((checkWord=words[idx].toLowerCase()).length>2){var charCode=checkWord.charCodeAt(0);(charCode<48||charCode>57)&&-1==$.inArray(checkWord,keywordList)&&keywordList.push(checkWord)}return keywordList}function SearchForKeywords(keywords,fileInfo,wordDictionary,sortByTitle){for(var matches=[],matchingFileIndices=[],rankings=[],isFirst=!0,idx=0;idx<keywords.length;idx++){var word=keywords[idx],occurrences=wordDictionary[word];if(null==occurrences)return"<strong>Nothing found</strong>";matches[word]=occurrences;var occurrenceIndices=[];for(var ind in occurrences)occurrenceIndices.push(Math.floor(occurrences[ind]/Math.pow(2,16)));if(isFirst)for(var matchInd in isFirst=!1,occurrenceIndices)matchingFileIndices.push(occurrenceIndices[matchInd]);else for(var checkIdx=0;checkIdx<matchingFileIndices.length;checkIdx++)-1==$.inArray(matchingFileIndices[checkIdx],occurrenceIndices)&&(matchingFileIndices.splice(checkIdx,1),checkIdx--)}if(0==matchingFileIndices.length)return"<strong>Nothing found</strong>";for(var fileIdx=0;fileIdx<matchingFileIndices.length;fileIdx++){for(var matchingIdx=matchingFileIndices[fileIdx],fileIndex=fileInfo[matchingIdx].split(/\0/),title=fileIndex[0],filename=fileIndex[1],wordCount=parseInt(fileIndex[2]),matchCount=0,idx=0;idx<keywords.length;idx++)for(var ind in occurrences=matches[keywords[idx]]){var entry=occurrences[ind];Math.floor(entry/Math.pow(2,16))==matchingIdx&&(matchCount+=65535&entry)}if(rankings.push({Filename:filename,PageTitle:title,Rank:1e3*matchCount/wordCount}),rankings.length>99)break}rankings.sort(function(x,y){return sortByTitle?x.PageTitle.localeCompare(y.PageTitle):y.Rank-x.Rank});var content="<ol>";for(var r in rankings)content+='<li><a href="'+rankings[r].Filename+'" target="_blank">'+rankings[r].PageTitle+"</a></li>";return content+="</ol>",rankings.length<matchingFileIndices.length&&(content+="<p>Omitted "+(matchingFileIndices.length-rankings.length)+" more results</p>"),content}function FindTOCLink(isHashUpdate){isHashUpdate&&$("#tocNav .current").removeClass("current");var filename=window.location.pathname.split("/").pop(),matchingTocLink;if(""==filename&&(filename="introduction.html"),filename=decodeURI(filename.toLowerCase()),(matchingTocLink=$("#tocNav a").filter(function(){return $(this).attr("href").toLowerCase()==filename+window.location.hash}))||(matchingTocLink=$("#tocNav a").filter(function(){return $(this).attr("href").toLowerCase()==filename})),matchingTocLink){var matchingTocNode=$(matchingTocLink).parent();"true"==$(matchingTocLink).attr("data-tochassubtree")&&$(matchingTocLink).prev().hasClass("tocCollapsed")&&Toggle($(matchingTocLink).prev()),$(matchingTocNode).addClass("current");for(var currentTocLevel=$(matchingTocNode).attr("data-toclevel"),previousTocNode=matchingTocNode;currentTocLevel>0;)if(previousTocNode=$(previousTocNode).prev(),previousTocLevel=$(previousTocNode).attr("data-toclevel"),previousTocLevel<currentTocLevel){var rollupLink=$(previousTocNode).children("a").first();$(rollupLink).hasClass("tocCollapsed")&&Toggle(rollupLink),currentTocLevel=previousTocLevel}}}$(document).ready(function(){if($(window).on("hashchange",function(){FindTOCLink(!0)}),$("#tocNav").hasClass("ssi-toc")){if("file:"==location.protocol){var webtocUrl="http://localhost/help/"+location.pathname.substring(location.pathname.lastIndexOf("build/")+"build/".length,location.pathname.lastIndexOf("/")+1)+"webtoc.html";$("#tocNav").html("If you see this message, it's because you are viewing the file locally in a way that doesn't support inserting the TOC."),$.support.cors=!0,$.ajax({async:!1,type:"GET",url:webtocUrl,success:function(data){$("#tocNav").html(data)},error:function(xhr,ajaxOptions,thrownError){console.log("Error retrieving webtoc.html via AJAX:"+thrownError)}})}FindTOCLink(!1),$("#tocNav").removeClass("loading")}});