(function(b){var a=[];function c(e){if(this.svgSprite.opt.file!==""&&a.indexOf(this.svgSprite.opt.file)==-1){var d=b('<div style="display: none;"/>');b("body").append(d);d.load(this.svgSprite.opt.file,(function(){a.push(this.svgSprite.opt.file);e.call(this)}).bind(this))}else{e.call(this)}}b.fn.svgSprite=function(d){this.svgSprite={opt:b.extend({file:"",ico:""},d)};if(this.length>0){c.call(this,(function(){this.each((function(e,f){f=b(f);if(f.data("ico")||this.svgSprite.opt.ico){f.html('<svg width="100%" height="100%"><use xlink:href="#'+(f.data("ico")||this.svgSprite.opt.ico)+'"></use></svg>')}}).bind(this))}).bind(this))}return this}})(jQuery);jQuery.fn.extend({scrollTo:function(a,b){return this.each(function(){var c=$(this).offset().top-50;$("html,body").animate({scrollTop:c},a,b)})}});
/*!
	Autosize v1.18.1 - 2013-11-05
	Automatically adjust textarea height based on user input.
	(c) 2013 Jack Moore - http://www.jacklmoore.com/autosize
	license: http://www.opensource.org/licenses/mit-license.php
*/
(function(b){var e={className:"autosizejs",append:"",callback:false,resizeDelay:10},f='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',a=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],d,c=b(f).data("autosize",true)[0];c.style.lineHeight="99px";if(b(c).css("lineHeight")==="99px"){a.push("lineHeight")}c.style.lineHeight="";b.fn.autosize=function(g){if(!this.length){return this}g=b.extend({},e,g||{});if(c.parentNode!==document.body){b(document.body).append(c)}return this.each(function(){var l=this,k=b(l),r,u,j=0,t=b.isFunction(g.callback),m={height:l.style.height,overflow:l.style.overflow,overflowY:l.style.overflowY,wordWrap:l.style.wordWrap,resize:l.style.resize},o,h=k.width();if(k.data("autosize")){return}k.data("autosize",true);if(k.css("box-sizing")==="border-box"||k.css("-moz-box-sizing")==="border-box"||k.css("-webkit-box-sizing")==="border-box"){j=k.outerHeight()-k.height()}u=Math.max(parseInt(k.css("minHeight"),10)-j||0,k.height());k.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word",resize:(k.css("resize")==="none"||k.css("resize")==="vertical")?"none":"horizontal"});function n(){var w,v;if("getComputedStyle" in window){w=window.getComputedStyle(l,null);v=l.getBoundingClientRect().width;b.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(x,y){v-=parseInt(w[y],10)});c.style.width=v+"px"}else{c.style.width=Math.max(k.width(),0)+"px"}}function q(){var w={};d=l;c.className=g.className;r=parseInt(k.css("maxHeight"),10);b.each(a,function(y,z){w[z]=k.css(z)});b(c).css(w);n();if(window.chrome){var v=l.style.width;l.style.width="0px";var x=l.offsetWidth;l.style.width=v}}function p(){var v,w;if(d!==l){q()}else{n()}c.value=l.value+g.append;c.style.overflowY=l.style.overflowY;w=parseInt(l.style.height,10);c.scrollTop=0;c.scrollTop=90000;v=c.scrollTop;if(r&&v>r){l.style.overflowY="scroll";v=r}else{l.style.overflowY="hidden";if(v<u){v=u}}v+=j;if(w!==v){l.style.height=v+"px";if(t){g.callback.call(l,l)}}}function i(){clearTimeout(o);o=setTimeout(function(){var v=k.width();if(v!==h){h=v;p()}},parseInt(g.resizeDelay,10))}if("onpropertychange" in l){if("oninput" in l){k.on("input.autosize keyup.autosize",p)}else{k.on("propertychange.autosize",function(){if(event.propertyName==="value"){p()}})}}else{k.on("input.autosize",p)}if(g.resizeDelay!==false){b(window).on("resize.autosize",i)}k.on("autosize.resize",p);k.on("autosize.resizeIncludeStyle",function(){d=null;p()});k.on("autosize.destroy",function(){d=null;clearTimeout(o);b(window).off("resize",i);k.off("autosize").off(".autosize").css(m).removeData("autosize")});p()})}}(window.jQuery||window.$));(function(b){b.event.special.realchange={setup:function(){var c=b(this).prop("tagName");var d=b(this).prop("type");if(!(/textarea/i.test(c)||(/input/i.test(c)&&/text/i.test(d)))){return false}a.init(b(this))},teardown:function(){a.finalize(b(this))}};b.fn.extend({realchange:function(c){return c?this.bind("realchange",c):this.trigger("realchange")},unrealchange:function(c){return this.unbind("realchange",c)}});var a={data:[],createDataObject:function(c){c.data("realchangedataindex",a.data.push({})-1);return a.data[a.data.length-1]},getDataObject:function(c){return a.data[c.data("realchangedataindex")]},deleteDataObject:function(c){delete a.data[c.data("realchangedataindex")]},change:function(c){c=b.event.fix(c||window.event);a.checkChange(b(this),c)},raiseChange:function(f,e,c,d){e=e||b.event.fix({});b.extend(e,{type:"realchange",target:f[0],info:{_old:c,_new:d}});return b.event.dispatch.apply(f[0],[e])},checkChange:function(f,d){var e=a.getDataObject(f);var c=e._value;var g=f.val();if(g!==c){a.raiseChange(f,d,c,g);e._value=g}},initInterval:function(e){var c=function(){a.intervalTick(e)};var d=a.getDataObject(e);d.intervalId=setInterval(c,500)},clearInterval:function(d){var c=a.getDataObject(d);clearInterval(c.intervalId)},intervalTick:function(c){a.checkChange(c)},init:function(c){a.innerInit(c)},finalize:function(c){a.innerFinalize(c)},innerInit:function(c){var e=a.createDataObject(c);e._value=c.prop("value");c.bind("focus",a.change);c.bind("blur",a.change);c.bind("keyup",a.change);c.bind("keydown",a.change);if(b.browser.msie){c[0].attachEvent("paste",a.change)}if(b.browser.safari){c[0].addEventListener("paste",a.change,false)}if(b.browser.mozilla){c[0].addEventListener("input",a.change,false)}if(b.browser.opera){c[0].addEventListener("change",a.change,false)}},innerFinalize:function(c){a.deleteDataObject(c);c.unbind("focus");c.unbind("blur");c.unbind("keyup");c.unbind("keydown");if(b.browser.msie){c[0].detachEvent("paste",a.change)}if(b.browser.safari){c[0].removeEventListener("paste",a.change,false)}if(b.browser.mozilla){c[0].removeEventListener("input",a.change,false)}if(b.browser.opera){c[0].removeEventListener("change",a.change,false)}}}})(jQuery);if(!this.JSON){JSON=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(key){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()};var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapeable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapeable.lastIndex=0;return escapeable.test(string)?'"'+string.replace(escapeable,function(a){var c=meta[a];if(typeof c==="string"){return c}return"\\u"+("0000"+(+(a.charCodeAt(0))).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value,rep);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value,rep);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}return{stringify:function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})},parse:function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+(+(a.charCodeAt(0))).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}()}function createCookie(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+d+a+"; path=/"}function readCookie(b){var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return f.substring(e.length,f.length)}}return null}function eraseCookie(a){createCookie(a,"",-1)}function xmlhttp(a,b){if(a==undefined){a=0}if(b==undefined){b=null}this.async=a;this.callback=b}xmlhttp.prototype.req=function(c,a,b){if(window.XMLHttpRequest){this.x=new XMLHttpRequest()}else{if(window.ActiveXObject){this.x=new ActiveXObject("Microsoft.XMLHTTP")}else{return false}}if(this.async){this.x.onreadystatechange=function(e,d){return function(){e.getresponse(d)}}(this,this.callback)}this.x.open(c,a,this.async?true:false);this.x.send(b);if(!this.async){return this.x}};xmlhttp.prototype.getresponse=function(a){if(this.x.readyState==4&&this.x.status==200){a(this.x)}};var _EventHandlers=new Array();var _EventHandlersId=0;function addEventHandler(c,b,a){_EventHandlers.push({obj:c,event:b,handler:a,id:++_EventHandlersId});if(c.attachEvent){c.attachEvent(b,a)}else{if(c.addEventListener){c.addEventListener(b.substr(2),a,false)}}return _EventHandlersId}function cleanEventHandlers(){var b,a;while((a=_EventHandlers.pop())!=undefined){if(a.obj.detachEvent){a.obj.detachEvent(a.event,a.handler)}else{if(a.obj.removeEventListener){a.obj.removeEventListener(a.event.substr(2),a.handler,false)}}}}function removeEventHandler(c){var b;for(b=0;b<_EventHandlers.length;b++){if(_EventHandlers[b].id==c){var a=_EventHandlers.splice(b,1)[0];if(a.obj.detachEvent){a.obj.detachEvent(a.event,a.handler)}else{if(a.obj.removeEventListener){a.obj.removeEventListener(a.event.substr(2),a.handler,false)}}break}}}addEventHandler(window,"onunload",cleanEventHandlers);function getTop(a){if(!a.offsetParent){return a.offsetTop}else{return getTop(a.offsetParent)+a.offsetTop}}function getLeft(a){if(!a.offsetParent){return a.offsetLeft}else{return getLeft(a.offsetParent)+a.offsetLeft}}var fadeCurrentOpacity=100;var fadeCurrentDirection=-2;var fadeStepInterval=150;var fadeId;function initFade(){fadeId=setInterval(stepFade,fadeStepInterval)}function stepFade(){fadeCurrentOpacity+=fadeCurrentDirection;if(fadeCurrentOpacity<=0){clearInterval(fadeId);return}var a;var b=document.getElementsByTagName("span");for(a=0;a<b.length;a++){if(b[a].className!="fade"){continue}b[a].style.opacity=""+(fadeCurrentOpacity/100);b[a].style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+fadeCurrentOpacity+")"}}(function(){$(document).ready(function(){$(".ico").svgSprite({file:"/res/default-white/img/icons.svg"});$(".cat").svgSprite({file:"/res/default-white/img/cats.svg"});$("#menuBut").click(b.bind(this,$("#menu"),null));$("#menuCloseBut").click(c.bind(this,$("#menu"),null));$("#searchBut").click(b.bind(this,$("#search"),$('#search input[name="q"]')));$("#searchCloseBut").click(c.bind(this,$("#search"),$('#search input[name="q"]')));$("#closeSubscribeBut").click(c.bind(this,$("#subscribe"),$('#subscribe input[type="text"]')));$("#catSelect").change(a.bind(this,$("#catSelect")))});$(window).load(function(){setTimeout(function(){$(".none").removeClass("none")},500)});function b(d,e){d.addClass("show");if(e){e.focus()}}function c(d,e){d.removeClass("show");if(e){e.val("")}}function a(d){window.location.assign(d.val())}})();var ControlLogin=Class.create({},{init:function(){this.crossDomainLoadStates={};this.loginButton=$("#"+this._serverData._ids.loginButton);this.logoutButton=$("#"+this._serverData._ids.logoutButton);this.login=$("#"+this._serverData._ids.login);this.password=$("#"+this._serverData._ids.password);this.errors=$("#"+this._serverData._ids.errorsBlock);this.loginButton.click(this.getHandler("loginButtonListener"));this.logoutButton.click(this.getHandler("logoutButtonListener"));this.login.keydown(this.getHandler("keydownListener"));this.password.keydown(this.getHandler("keydownListener"));$("#"+this._serverData._ids.loginForm).on("submit",function(){return false})},frameInit:function(f,a,e,d){for(var c in this._serverData.crossDomains){this.crossDomainLoadStates[c]=false}for(var c in this._serverData.crossDomains){var b=$("#"+c);b.load(this.getHandler("iframeLoadListener",[c,f,a]));b.attr("src","//"+this._serverData.crossDomains[c]+"/cross-login.htm?token="+e+"&t="+d)}},clearMessages:function(){this.errors.empty()},showMessages:function(c){for(var b in c){var a=$.trim($("<span>"+c[b]+"</span>").text());if(a.length>0){this.errors.append($("<li>"+a+"</li>"))}}},keydownListener:function(a){if(a.which==13){a.preventDefault();this.loginButtonListener()}},loginButtonListener:function(){if(this.loginButton.prop("disabled")==false){this.loginButton.prop({disabled:true});var a={};a[this._serverData._actions.getLoginToken]=true;a[this._serverData._fields.login]=this.login.val();a[this._serverData._fields.password]=this.password.val();$.post(location.href,a,(function(d){if(d.errorNum){if(this._serverData.redirectOnError){var b="//"+this._serverData.defaultDomain+"/login.htm?redir="+encodeURIComponent(location.href);for(var c in d.errors){b+="&err[]="+encodeURIComponent(c)}window.location.assign(b)}else{this.clearMessages();this.showMessages(d.errors);this.password.val("");this.loginButton.prop({disabled:false})}}else{this.clearMessages();this.frameInit("login",d.url,d.token,d.t)}}).bind(this),"json")}return false},logoutButtonListener:function(){if(this.logoutButton.prop("disabled")==false){this.logoutButton.prop({disabled:true});var a={};a[this._serverData._actions.getLogoutToken]=true;$.post(location.href,a,(function(b){if(b.token.length){this.frameInit("logout","",b.token,b.t)}else{this.logoutButton.prop({disabled:false})}}).bind(this),"json")}return false},iframeLoadListener:function(b,e,f){this.crossDomainLoadStates[b]=true;var a=true;for(var d in this.crossDomainLoadStates){a=a&&this.crossDomainLoadStates[d]}if(a){var c=location.protocol+"//"+location.host+location.pathname+location.search;if(e=="login"){if(this._serverData.redirectOnSuccessURL){c=this._serverData.redirectOnSuccessURL}else{if(f){c=f}}}window.location.assign(c)}}},[Control]);var ControlCrossDomainCookies=Class.create({},{load:function(){for(var a in this._serverData.domains){var b=this.getIFrame(a);b.attr("src","//www.wisegeek.com/cross-cookies.php?t="+this._serverData.t+"&timing="+this._serverData.timing)}},getIFrame:function(a){var b=$("#"+this._serverData.ids+"_"+a);if(b.length==0){b=$('<iframe id="'+(this._serverData.ids+"_"+a)+'" src="/blank.txt" />');$("body").append($('<div style="display: none;" />').append(b))}return b}},[Control]);var ControlCustomSearch=Class.create({},{init:function(){this.timerId=null;this.cache={};this.queryStr="";this.shown=false;this.countItems=0;this.selectedItem=null},load:function(){var a=this._serverData.crossDomain;this.box=$("#searchBox");if(a==false){this.inp=this.box.find('input[name="q"]');this.aside=this.box.find("aside");this.http=new xmlhttp(1,this.updateContents.bind(this));this.inp.on("keyup",this.getHandler(this,"keyup"));this.inp.on("keydown",this.getHandler(this,"keydown"));this.aside.on("mouseout",this.getHandler(this,"selectItem",[-1]));$("body").on("click",this.getHandler(this,"hidePopup"))}this.box.after($('<script type="text/javascript" src="//www.google.com/cse/brand?form=searchBox&lang=en" />'))},query:function(a){if(this.cache[a]==undefined){this.queryStr=a;if(a.length>2){this.http.req("GET","//"+location.host+"/searchSuggestHandler.htm?q="+escape(a));this.timerId=null}else{this.cache[a]={responseText:""}}}else{this.updateContents(this.cache[a])}},updateContents:function(d){if(d.readyState!=undefined){this.cache[this.queryStr]={responseText:d.responseText}}var c=$("<ul/>");var a=$(d.responseText).find("a");this.aside.find("a").off(".SuggestBox");this.selectedItem=null;this.countItems=a.length;if(this.countItems===""){this.hidePopup();return}for(var b=0;b<this.countItems;b++){var e=a.eq(b).clone();e.attr("data-index",b);e.on("mouseover.SuggestBox",this.selectItem.bind(this,b));c.append($("<li/>").append(e))}this.aside.empty();this.aside.append(c);this.showPopup()},selectItem:function(g){if(this.selectedItem!==null){this.selectedItem.removeClass("bkg-blue txt-white")}if(g==-1){this.selectedItem=null;return}this.selectedItem=this.aside.find('a[data-index="'+g+'"]');if(this.selectedItem.length>0){var c=this.selectedItem.filter(":visible");var b=c.position().top;var a=c.closest(this.aside);var e=a.scrollTop();if(b+e<e){a.scrollTop(b+e)}else{var f=c.outerHeight();var d=a.outerHeight();if(b+f+e>d+e){a.scrollTop(e+b+f-d)}}c.addClass("bkg-blue txt-white")}},keydown:function(a){if(this.shown===false||this.countItems===0){return}var b=true;switch(a.keyCode){case 13:if(this.selectedItem===null){return}else{window.location.assign(this.selectedItem.eq(0).attr("href"))}break;case 38:if(this.selectedItem===null){this.selectItem(0)}else{this.selectItem((Number(this.selectedItem.eq(0).attr("data-index"))+this.countItems-1)%this.countItems)}break;case 40:if(this.selectedItem===null){this.selectItem(0)}else{this.selectItem((Number(this.selectedItem.eq(0).attr("data-index"))+1)%this.countItems)}break;case 27:this.selectItem(-1);b=false;break;default:b=false}if(b){a.returnValue=false;a.preventDefault()}},keyup:function(a){if(a.keyCode==38||a.keyCode==40){return}clearTimeout(this.timerId);this.timerId=setTimeout(this.query.bind(this,$(a.target).val()))},hidePopup:function(){if(this.shown){this.aside.hide();this.shown=false}},showPopup:function(){if(this.shown==false){this.aside.show();this.aside.scrollTop(0);this.shown=true}}},[Control]);(function(){this.form=$("#subscribe form");this.form.on("submit",(function(){if($.trim(this.form.find('input[name="email"]').val())===""){return false}}).bind(this))})();var ControlDiscussionPostsList=Class.create({},{init:function(){this.box=$("#comments");this.isChnagePopstate=false;if(location.hash==="#discussions"){location.hash="#comments"}},load:function(){if(this.box.length>0){this.isChnagePopstate=false;$(window).scroll(this.getHandler("scrollDiscussion"));$(window).bind("popstate",this.getHandler("changePopstate"))}},scrollDiscussion:function(a,b){if(this.isChnagePopstate==false){var c=$(window);if(location.hash!=="#comments"){if(c.scrollTop()+c.height()/2>=this.box.offset().top){history.pushState(null,null,location.protocol+"//"+location.host+location.pathname+location.search+"#comments")}}else{if(c.scrollTop()+c.height()/2<this.box.offset().top){history.pushState(null,null,location.protocol+"//"+location.host+location.pathname+location.search)}}}else{this.isChnagePopstate=false}},changePopstate:function(){this.isChnagePopstate=true}},[Control]);var ControlDiscussionModeratorPostsList=Class.create({},{init:function(){this.editPostsRequestCount=0;this.postsContainer=$("#"+this._serverData._ids.postsContainer);this.editPostButs=this.postsContainer.find(".edit-but");this.savePostsBut=$("#"+this._serverData._ids.savePosts);this.savePostsGoNextBut=$("#"+this._serverData._ids.savePostsGoNext);this.disableControls(true)},load:function(){this.postsContainer.find(".edit-but").click(this.getHandler("editPostListener"));this.savePostsBut.click(this.getHandler("savePostsListener"));this.savePostsGoNextBut.click(this.getHandler("savePostsGoNexListener"));if(this._serverData.postsToEdit.length>0){this.editPosts(this._serverData.postsToEdit)}else{this.editPostButs.prop({disabled:false})}},findPostContainer:function(a){return this.postsContainer.find("#post_"+a)},disableControls:function(a){this.savePostsBut.prop({disabled:a?true:false});this.savePostsGoNextBut.prop({disabled:a?true:false});this.editPostButs.prop({disabled:a?true:false});this.postsContainer.find(".post-edit").find("textarea, input, select").prop({disabled:a?true:false})},editPosts:function(b){if(b.length==0){return false}this.editPostsRequestCount++;this.savePostsBut.prop({disabled:true});this.savePostsGoNextBut.prop({disabled:true});var a={};a[this._serverData._actions.editPosts]=true;a["editPostIdList[]"]=b;$.post(this._serverData.url,a,(function(f,c){if(c=="success"){try{var e=JSON.parse(f);for(var g in e){this.initPostEditUI(g,e[g])}if(this._serverData.editPost){this.findPostContainer(this._serverData.editPost).scrollTo();this._serverData.editPost=null}}catch(d){alert("Error happened while loaded post.\n Try again later.")}}this.editPostsRequestCount--;if(this.editPostsRequestCount===0){this.disableControls(false)}}).bind(this))},saveAllPosts:function(a){this.disableControls(true);var b={};b[this._serverData._actions.savePosts]=true;b.posts=JSON.stringify(this.getEditedPostsData());b.retrieveNextUrl=a;$.post(this._serverData.url,b,(function(e,c){if(c=="success"){try{e=JSON.parse(e);window.location.assign(e.url)}catch(d){alert("Error happened while saving posts. \n Page will be reloaded.");window.location.reload()}}else{alert("Error happened while saving posts. \n Page will be reloaded.");window.location.reload()}}).bind(this))},getEditedPostsData:function(){var c={};var e=this.postsContainer.find(".post-edit");for(var a=0;a<e.length;a++){var b=e.eq(a);var d={id:$.trim(b.find('[name="postId"]').val()),content:$.trim(b.find('[name="content"]').val()),deletePost:Boolean(b.find('[name="deletePost"]').is(":checked")),error:$.trim(b.find('[name="error"]').val()),isInResearchv:Boolean(b.find('[name="isInResearch"]').is(":checked")),deleteUser:Boolean(b.find('[name="deleteUser"]').is(":checked")),editorNote:$.trim(b.find('[name="editorNote"]').val()),mail:$.trim(b.find('[name="mail"]').val())};c[d.id]=d}return c},initPostEditUI:function(a,b){b=$(b.replace(/\\n/g,"\n"));b.find(".ico").svgSprite({file:"/res/default-white/img/icons.svg"});b.find('[name="content"]').autosize({append:"\n\n"});b.find("#nuc_search_"+a).click(this.getHandler(this,"nucSearchListener",[b.find('[name="content"]')]));b.find('[name="useEmailTemplate"]').click(this.getHandler(this,"emailTemplateListener",[b.find('[name="emailTemplate"]'),b.find('[name="mail"]')]));b.find("form").on("submit",function(){return false});this.findPostContainer(a).empty().append(b).addClass("brd-dark")},nucSearchListener:function(c){var a=c.val().split(" ");var f=Math.ceil(Math.random()*Math.max(a.length-10,0));var b=Math.min(f+11,a.length);var e=a.slice(f,b);var d=e.join(" ");window.open("http://www.google.com/search?q="+escape(d));return false},emailTemplateListener:function(b,a){var c=b.val();a.val(String(this._serverData.emailTemplates[c]));a.focus();return false},editPostListener:function(c,b){var b=this.editPostButs.filter(b);var a=b.data("post-id");b.prop({disabled:true});this.editPosts([a]);return false},savePostsListener:function(b,a){$(a).text("Saving...");this.saveAllPosts(false);return false},savePostsGoNexListener:function(b,a){$(a).text("Saving...");this.saveAllPosts(true);return false}},[Control]);var ControlDiscussionPostBox=Class.create({},{init:function(){this.form=$("#"+this._serverData._ids.postForm);this.content=this.form.find('[name="'+this._serverData.contentTA+'"]');this.submit=$("#"+this._serverData._ids.createPost);this.captcha=$("#"+this._serverData._ids.captcha);this.notification=$("#"+this._serverData._ids.notification);this.messages=$("#"+this._serverData._ids.messages);this.errors=$("#"+this._serverData._ids.errors);this.captchaID="";this.creatNewPostState=false;this.declareEvent("change");this.form.on("submit",this.getHandler("submitListener"));this.content.realchange(this.getHandler("postBoxChangeListener"));if(this._serverData.autosizeTextarea){this.content.autosize({append:"\n"})}},isNeedCaptcha:function(){return this.captcha.length>0&&this.captcha.is(":visible")==false?true:false},showCaptcha:function(){var b=this.captcha.find('[name="'+this._serverData.captchaText+'"]');var a={};a[this._serverData._actions.getCaptchaId]=true;this.submit.prop({disabled:true});$.post(this._serverData.url,a,(function(c){this.captchaID=c;this.captcha.find("img").attr("src","/captcha.php?id="+c+"&cl=e9e9e9&"+(new Date()).getTime());this.captcha.find("[name="+this._serverData.captchaId+"]").val(c);this.submit.prop({disabled:false})}).bind(this),"json");b.val("");this.notification.hide();this.captcha.show();b.focus()},hideCaptcha:function(){this.captcha.hide();this.notification.show();this.captcha.find("img").attr("src","");this.captcha.find('[name="'+this._serverData.captchaText+'"]').val("")},reloadCaptcha:function(){this.captcha.find("img").attr("src","");this.captcha.find('[name="'+this._serverData.captchaText+'"]').val("");this.showCaptcha()},clearMessages:function(a){a.empty()},showMessages:function(c,d){for(var b=0;b<d.length;b++){var a=$.trim(d.eq(b).text());if(a.length>0){c.append($("<li>"+a+"</li>"))}}},postForm:function(){var a={};a[this._serverData._actions.checkDiscussionPost]=true;a[this._serverData.captchaId]=this.captchaID;a[this._serverData.captchaText]=this.captcha.find('[name="'+this._serverData.captchaText+'"]').val();a[this._serverData.dPostContent]=this.content.val();this.creatNewPostState=false;this.submit.prop({disabled:true});$.post(this._serverData.url,a,(function(c,b){this.submit.prop({disabled:false});if(b==="success"){this.clearMessages(this.messages);this.clearMessages(this.errors);if(c.errorState==false){this.creatNewPostState=true;if(c.captchaIsNeed){this.showMessages(this.messages,$(c.body))}this.form.submit()}else{this.showMessages(this.errors,$(c.body));if(c.captchaIsNeed){this.reloadCaptcha()}}}}).bind(this),"json")},submitListener:function(){if(this.submit.prop("disabled")){return false}else{if(this.isNeedCaptcha()){this.showCaptcha();return false}else{if(this.creatNewPostState==false){this.postForm();return false}}}},postBoxChangeListener:function(b,a){this.dispatchEvent("change",[$(a).val()])}},[Control]);var ControlDiscussionKeywordSuggestions=Class.create({},{init:function(){this.keywords=[];this.stemDb=[];this.postboxTimeuutId=null;this.list=$("#"+this._serverData._ids.keywordsListContainer);this.progress=$("#"+this._serverData._ids.progressIndicator);this.list.hide();this.progress.show()},load:function(){this.loadStemDb();this._parentControl.addEventListener("change",this.getHandler("postboxListener"));setTimeout(this.getHandler("loadKeywords"),1000)},loadKeywords:function(){var a={};a[this._serverData._actions.getKeywords]=true;$.post(location.href,a,(function(c,b){this.keywords=b=="success"?c:[];this.renderKeywords();this.progress.hide();this.list.show()}).bind(this),"json")},loadStemDb:function(){$.get("/res/common/js/utils/stemmedWords.txt",(function(result){try{eval(result);this.stemDb=s}catch(excep){}}).bind(this),"text")},processContent:function(a){var b={};b[this._serverData._actions.stemContent]=true;b.content=a;$.post(location.href,b,(function(f){var d=false;for(var e=0;e<this.keywords.length;e++){if(!this.keywords[e].stemmedKeyword){this.keywords[e].stemmedKeyword=this.stem(this.keywords[e].keyword);this.keywords[e].prevState=this.keywords[e].state}var c=this.findMatch(this.keywords[e].stemmedKeyword,f)?"postbox":this.keywords[e].prevState;d=d||this.keywords[e].state!=c?true:false;this.keywords[e].state=c}if(d){this.renderKeywords()}}).bind(this),"json")},stem:function(e){var c=new RegExp("\\W+");var b=e.toLowerCase().split(c);var d=[];for(var a=0;a<b.length;a++){d[a]=b[a]&&this.stemDb.words[b[a]]?this.stemDb.words[b[a]]:b[a]}return d},findMatch:function(k,l){var h=l.length-k.length+1;var d=2;var a=false;var f=0;while(f<h&&a==false){var e=0;var g=1;var b=f;while(g>=0&&e<k.length&&b<l.length){if(k[e]==l[b]){e++;g=d}else{g--}b++}a=e==k.length?true:false;f++}return a},renderKeywords:function(){var d=$();if(this.keywords.length>0){var g=this.getHandler(this,"flagKeywordListener",[this._serverData._actions.flagKeyword]);var c=this.getHandler(this,"flagKeywordListener",[this._serverData._actions.unflagKeyword]);for(var b=0;b<this.keywords.length;b++){var a='<button class="ico grey fleft" data-ico="close-tiny" data-id="'+this.keywords[b].id+'"></button>';var f='<a href="//www.google.com/search?q='+this.keywords[b].keyword+'" target="_blank">'+this.keywords[b].keyword+"</a>";switch(this.keywords[b].state){case"post":d=d.add($('<li class="fclear txt-light"><s>'+f+"</s></li>"));break;case"postbox":d=d.add($('<li class="fclear txt-grey"><s>'+f+"</s></li>"));break;case"active":var e=$('<li class="fclear txt-blue">'+a+f+"</li>");e.find("button").click(g);d=d.add(e);break;case"user":var e=$('<li class="fclear txt-light">'+a+"<s>"+f+"</s></li>");e.find("button").click(c);d=d.add(e);break}}}else{d=d.add($('<li class="txt-light">No keywords found.</li>'))}d.find(".ico").svgSprite({file:"/res/default-white/img/icons.svg"});this.list.empty().append(d)},postboxListener:function(a,b){clearTimeout(this.postboxTimeuutId);this.postboxTimeuutId=setTimeout(this.getHandler("processContent",[a]),2000)},flagKeywordListener:function(d,b,a){var a=$(a);a.prop({disabled:true});var c={};c[d]=true;c.keywordId=a.data("id");$.post(location.href,c,(function(f,e){this.keywords=e=="success"?f:this.keywords;this.renderKeywords()}).bind(this),"json");return false}},[Control]);var PageArticle=Class.create({},{init:function(){this.qgLoader=this.getHandler("qgScrollListener");this.qgGame=$("#quizgeek-game");this.qgLoaderDist=100;this.qgLoaderUrl="//quizgeek."+this._serverData.baseWgDomain+"/firstQuestion?tpl=wisegeek";$(document).ready(this.getHandler(function(){if(this.qgGame.length>0){$(window).scroll(this.qgLoader);this.qgScrollListener()}}))},load:function(){this.loadOtherScripts()},qgScrollListener:function(){var a=$(window);if(a.scrollTop()+a.height()>=this.qgGame.offset().top-this.qgLoaderDist){var b=this.qgGame.children("iframe");a.unbind("scroll",this.qgLoader);b.ready(this.getHandler(function(){this.qgGame.children(".loader").fadeOut(300,this.getHandler(function(){b.fadeIn(300)}))}));b.attr({src:this.qgLoaderUrl})}},loadOtherScripts:function(){(function(id){var s=document.getElementById(id);if(s){var params=eval(s.getAttribute("params"));var scriptFile=s.getAttribute("scriptName");var po=document.createElement("script");var qs="";for(var key in params){qs+=key+"="+params[key]+"&"}qs=qs.substring(0,qs.length-1);po.type="text/javascript";po.async=true;po.src="//api.content.ad/Scripts/"+scriptFile+"?"+qs;s.parentNode.insertBefore(po,s)}})("contentAd");(function(id){var parentEl=$("#"+id);if(parentEl.length>0){var i=$('<iframe scrolling="no" frameborder="0" allowTransparency="true" src="//www.facebook.com/plugins/likebox.php?href=https%3A%2F%2Fwww.facebook.com%2FwiseGEEK&width=292&colorscheme=light&show_faces=true&height=258&stream=false&show_border=true&header=false&appId=115218921845642" />');i.css({border:"none",overflow:"hidden",width:"100%",height:"100%",fontFamily:"Droid Sans,Arial,sans-serif"});parentEl.append(i)}})("facebookBlock")}},[Page]);var PageLogin=Class.create({},{},[Page]);var PagePasswordRecovery=Class.create({},{},[Page]);